
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Illusory stillness</title>
  <meta name="author" content="Peter Meilstrup">

  
  <meta name="description" content="From earlier, I had the following complaints about flycheck: As I edit code I&rsquo;m getting this annoyingly big message in the minibuffer: &#8220 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://crowding.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Illusory stillness" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Illusory stillness</a></h1>
  
    <h2>mumble mumble techblog</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:crowding.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/09/20/racket-and-flycheck-mode/">Racket and Flycheck-mode</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-20T16:26:23-07:00" pubdate data-updated="true">2014-09-20</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>From <a href="{*post-url%202014-09-05-get-emacs-set-up-for-racket.markdown*}">earlier</a>, I had the following complaints about flycheck:</p>

<blockquote><p>As I edit code I&rsquo;m getting this annoyingly big message in the minibuffer:</p>

<p>&#8220;`
Checker racket returned non-zero exit code 1, but no errors from output: r5rs:body: no expression in body
  in: (r5rs:body (define (new-record data) attach-tag data) (define (get-record name) (new-record data)) (define (get-salary record) (quote salary)))
  context&hellip;:
   /Applications/Racket v6.1/share/pkgs/r5rs-lib/r5rs/main.rkt:335:2</p>

<p>Checker definition probably flawed.
&#8220;`</p>

<p>In other words, one kind of syntax error (no expression on body) is not getting interpreted as an &ldquo;error&rdquo;.</p></blockquote>

<p>To fix this, I need to fix the error patterns that Racket checker uses, to make it catch a certain error as an error.</p>

<p>Now, what is some example output from the racket compiler? I ran <code>M-! racket -f chap3.1.rkt</code> and went to the <code>*Shell Command Output*</code> buffer.</p>

<p>I will play with regexp-builder on that, but how do I add error patterns to the existing thing?</p>

<p>Additionally, I find that the error highlighting is one character off. Racket reporting zero-based colukmn numbers or something. Also the entire following sexp should be underlined (as opposed to underlining a single paren.)</p>

<h3>more advanced syntax checking?</h3>

<p>Well, Racket actually <a href="http://docs.racket-lang.org/tools/Check_Syntax.html">has a syntax checker module</a>, while this is just reporting the errors on trying to load a file. So how to make emacs talk to <code>drracket/check-syntax</code> package? Apparently one must write a Racket script. I don&rsquo;t know what it is saying about syntax objects. <code>(make-traversal ...)</code> apparently makes a Visitor type thing, but where do I get the visited?</p>

<p><a href="http://docs.racket-lang.org/reference/syntax-model.html#%28part._stxobj-model%29">Syntax objects</a></p>

<p>On the other hand, I don&rsquo;t see the &ldquo;Check Syntax&rdquo; button in DrRacket giving any more information about those pesky &ldquo;no expression in body&rdquo; errors (like a line number would be helpful!)</p>

<p>Okay, put this down for now.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&gt; (make-traversal (make-base-namespace) "chap3.1.rkt")
</span><span class='line'>#&lt;procedure:expanded-expression&gt;
</span><span class='line'>#&lt;procedure:expansion-completed&gt;</span></code></pre></td></tr></table></div></figure>


<blockquote><p>Actually this particular syntax error (at least when writing code in the <code>#lang planet neil/sicp</code> module) is annoying because it won&rsquo;t point you to the line on which error occurs despite it being mostly syntax. Usually turns out to be an &lsquo;if&rsquo; with no clauses, a duplicated paren, or something.</p>

<p>Additionally, the red underline that flycheck puts is misplaced and tiny (it is frequently on an open paren, when it should really be on all of the first sexp inside that paren).</p></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/09/09/fixing-geiser-racket-repls-error-links/">Fixing Geiser-racket-repl&#8217;s Error Links</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-09T22:36:52-07:00" pubdate data-updated="true">2014-09-09</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Geiser REPL mode is pretty good, but man the error links were (a) broken and (b) eyewatering. Here&rsquo;s an example:</p>

<p>Error processing input, expected syntax: {% img [class name(s)] [http[s]:/]/path/to/image [width [height]] [title text | &ldquo;title text&rdquo; [&ldquo;alt text&rdquo;]] %}</p>

<p>I mean, are there error messages somewhere in all those pathnames and red?</p>

<p>After some fussing I got it to look better.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/09/09/fixing-geiser-racket-repls-error-links/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/09/09/editing-regexes-interactively-in-emacs/">Editing Structured Regexes Interactively in Emacs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-09T15:50:44-07:00" pubdate data-updated="true">2014-09-09</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I was using regex-builder to make something, but it still looked like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"^ *\\([^:(\t\n]+\\)\\(:\\([0-9]+\\)\\)?\\(:\\([0-9]+\\)\\)?\\(: \\(\\(\\w\\|\\s_\\)+\\|\\[\\(\\w\\|\\s \\)+\\]\\)\\)?\\(: \\(.*\\)\\)?"</span></code></pre></td></tr></table></div></figure>


<p>Leaning-toothpicks syndrome is kicking my ass. What if I write a regex using S-expressions? Wouldn&rsquo;t that be the bee&rsquo;s knees?</p>

<p>Well, one thing I can do use use the <code>rx</code> macro, but <code>re-builder</code> doesn&rsquo;t seem to want to work with it. I call <code>(reb-change-syntax)</code> to select &lsquo;rx&rsquo; but it only performs a search sometimes? And often finds no matches?</p>

<p>Debugging from this impetus I get to stepping through <code>reb-update-overlays</code> but I can&rsquo;t inspect the value of local variables in either <code>edebug</code> or <code>debug</code> for some weird reason. (Because of <code>-*- lexical-binding:t -*-</code> in the file.)</p>

<p>New yak frame: how to inspect vars in  lexically bound code? It&rsquo;s probably impossible, though there was an incomplete <a href="http://emacs.1067599.n5.nabble.com/Edebug-amp-lexical-scope-td202618.html">thread</a> about it a couple years ago.</p>

<p>Well, I guess I&rsquo;ll debug it by adding messages.</p>

<p>Now, I find that when I use <code>(rx (one-or-more "/"))</code>, that macro should expand to <code>"/+"</code> but but the regexp we search for is actually <code>"\\(?:/\\+\\)"</code> which doesn&rsquo;t look like a proper regex. What is <code>reb-target-binding</code> doing? Pulling the binding from the target buffer. What&rsquo;s <code>reb-cook-regexp</code> doing? Calling <code>rx-to-string</code> on the result of an <code>rx</code> macro. Which it shouldn&rsquo;t?</p>

<p>Oh, I was typing</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(rx (one-or-more ":"))</span></code></pre></td></tr></table></div></figure>


<p>in the buffer like a sucker (idk, that&rsquo;s what you would write in Elisp?). Turns out I need to type</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>'(one-or-more ":")</span></code></pre></td></tr></table></div></figure>


<p>So how do I do a longer regex????? Use <code>and</code>/<code>seq</code>. It should be called <code>progn</code>, shouldn&rsquo;t it? Turns out I should write in regexp-builder like</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>'(seq (one-or-more ":") (class )</span></code></pre></td></tr></table></div></figure>


<p>So now I write regexps in regexp-builder like:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>'(seq bol (zero-or-more " ")
</span><span class='line'>      (group (one-or-more (not (char ":\n\t"))))
</span><span class='line'>      (zero-or-one ":" (group (one-or-more digit)))
</span><span class='line'>      (zero-or-one ":" (group (one-or-more digit)))
</span><span class='line'>      (zero-or-one ": " (group (one-or-more (or (syntax word) (syntax symbol))))))</span></code></pre></td></tr></table></div></figure>


<p>and then paste the <code>(seq ...)</code> into an <code>(rx ...)</code> macro when I&rsquo;m done.</p>

<p>Well, there&rsquo;s one more problem. Sometimes I can type a correct regexp and it won&rsquo;t update (it actually removes all highlights). Seems to have something to do with regexp-builder behaving inappropriately when an edit doesn&rsquo;t change the compiled form of the regexp. But I can then call <code>(reb-force-update)</code> and it does, that&rsquo;ll work for now.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/09/05/get-emacs-set-up-for-racket/">Get Emacs Set Up for Racket</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-05T13:24:15-07:00" pubdate data-updated="true">2014-09-05</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want to get back to doing problems out of SICP, but I want to use a more familiar editor.</p>

<p>Racket suggests Geiser and Quack. I already have Geiser installed from sopme package archive when I aborted an earlier attempt (and Geiser is supposed to, independently, include a version of Quack, or something?)</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014/09/05/get-emacs-set-up-for-racket/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/23/a-strange-writing-tic/">A Strange Writing Tic</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-23T17:07:19-07:00" pubdate data-updated="true">2014-08-23</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So I recently read <em>Turing&rsquo;s Cathedral</em> by George Dyson, and then I read <em>Sons of the Profits,</em> and realized they both have the same verbal tic that I found made them hard to keep going with. The problem is that they  have paragrapph and section breaks that leave as much hanging in the air as possible.</p>

<p>This is a technique that, in the right hands, provides some driving force and compellingness to a narrative, but when overused makes a book more difficult to read. The basic structure looks something like this:</p>

<p><em>things about Person A</em>
<em>Oblique, unexplained reference or injoke about Person B in context</em>
<em>Paragraph break</em>
<em>Introduction of Person B</em>
<em>Explanation of injoke from previous paragraph</em>
<em>Things person B does</em></p>

<p>Between the end of the last paragraph and the beginning of the next there is a lot hanging in the air.</p>

<p>If you leave off, or attempt to navigate and backtrack the text by paragraph (as is the frigging point of having paragraphs) you either start reading character description, about Person_B with no idea why he was playing a role in the story, or you start wondering why Person A trailed off. Conversely, if you time your preaks in reading between sections (as is also the purpuse of sections) you always end in the unsatisfying note of the last thiung being said making no sense yet.</p>

<p>When_I read a non fiction book, it is usually in smaller chunks, while fiction is often better suited for longer stretches. When read in a stretch these split references add some narrative tension (by momentarily loading up the reader&rsquo;s short term memory with unresolved details), but given a pattern of reading in bits in pieces I found the split references to impede my understanding, always forcing me to back track from that I thought looked like the start of a section. When, it felt like you might on reading this:</p>

<p>Let me try and find some examples rather than being all abstract.:</p>

<p>I could also embed these quotes amid the stream of this text, to simulate taking a break from the writing&hellip;.</p>

<p>As you started the previous paragraph, you probably got a strong sense that you were forgetting something._This may have forced you to go back to the previous block quote, to recall the details of the ideas left</p>

<p>These two books employed this tic in different ways. <em>Sons of the Profits</em> had more or less freestanding chapters, but employed a bridging reference between damn near every subsection, like this. This made it annoyingly hard to find places to break, and correspindingly, hard to recover one&rsquo;s place on resuming (for which one needs to locate enough context to get short one&rsquo;s short term memory loaded.)</p>

<p><em>Turing&rsquo;s  Cathedral</em> committed the opposite offense: each <em>chapter</em> ended with an unresolved reference to a person in the following chapter. An example follows.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/08/16/replace-less-with-emacs/">Replace Less With Emacs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-16T12:31:20-07:00" pubdate data-updated="true">2014-08-16</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I use shell-mode in Emacs a lot (and have never been that taken with Eshell or term-mode). I got tired of seeing this sort of thing:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dekkera:htlatex-maximal peter$ git log
</span><span class='line'>WARNING: terminal is not fully functional
</span><span class='line'>-  (press RETURN)</span></code></pre></td></tr></table></div></figure>


<p>It&rsquo;s reasonable for commands that generate a lot of output to go through <code>less</code>, but <code>less</code> works poorly in an Emacs buffer.</p>

<p>However, Emacs itself is quite good at paging. So I wondered if I could make Emacs take over for <code>less</code>. I wrote this shell script <code>emacs-pager</code> and placed it on my <code>$PATH</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/bash
</span><span class='line'>#A script for $PAGER that redirects to an Emacs buffer
</span><span class='line'>
</span><span class='line'># get the command line whose output I am paging
</span><span class='line'>COMMAND=$(echo "$(ps -o 'command=' -p $(ps -o 'ppid=' $$))" | sed -e 's/["\\]/\\&/g' -e 's/["\\]/\\&/g')
</span><span class='line'>
</span><span class='line'># make a named fifo
</span><span class='line'>FIFO=$(mktemp -ut pager.$$)
</span><span class='line'>mkfifo $FIFO
</span><span class='line'>
</span><span class='line'># tell emacs to to read that fifo into a buffer
</span><span class='line'>read -d '' LISP &lt;&lt;EOF
</span><span class='line'>(let* ((buf (generate-new-buffer "*${COMMAND}*"))
</span><span class='line'>       (proc (start-process "PAGER" buf "cat" "$FIFO")))
</span><span class='line'>   (view-buffer buf 'kill-buffer)
</span><span class='line'>   ; make sure point stays at top of window while process output accumulates
</span><span class='line'>   (set-process-filter proc
</span><span class='line'>     (lambda (proc string)
</span><span class='line'>       (let ((buf (process-buffer proc))
</span><span class='line'>             (mark (process-mark proc)))
</span><span class='line'>       (with-current-buffer buf
</span><span class='line'>         (let ((buffer-read-only nil))
</span><span class='line'>           (save-excursion
</span><span class='line'>             (goto-char mark)
</span><span class='line'>             (insert string)
</span><span class='line'>             (ansi-color-apply-on-region mark (point))
</span><span class='line'>             ; TODO also support backspace overstriking
</span><span class='line'>             (set-marker mark (point)))))))))
</span><span class='line'>EOF
</span><span class='line'>
</span><span class='line'># echo "$LISP"
</span><span class='line'>
</span><span class='line'>emacsclient -e "$LISP"
</span><span class='line'>
</span><span class='line'>cat &gt; "$FIFO"</span></code></pre></td></tr></table></div></figure>


<p>Then I made sure the following was in my <code>init.el</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(server-start)
</span><span class='line'>(unless (getenv "TERM_PROGRAM")
</span><span class='line'>  (setenv "TERM" "xterm"))
</span><span class='line'>(setenv "PAGER" "emacs-pager")</span></code></pre></td></tr></table></div></figure>


<p>Now when I invoke <code>git log</code> or <code>man</code>, the output appears in a new paging buffer.</p>

<ul>
<li>Note use of &ldquo;ps&rdquo; to figure out what to call the buffer.</li>
<li>Note use of <code>printf '%q'</code> to double escape the string that is substituted into Lisp code. (Why did I need double escaping? Shell scripting is terrible is why.)</li>
<li>The <code>'kill-buffer</code> means that the paging buffer will be deleted when you press &ldquo;q&rdquo;. This is not standard Emacs behavior but I don&rsquo;t want a whole gaggle of temporary buffers laying around.</li>
<li>The process filter is there just to keep point at the top of the buffer as you receive input.</li>
<li>There was a weird interaction with Emacs&#8217; builtin <code>M-x man</code> command. I worked around it with:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(defadvice man (around reset-pager activate)
</span><span class='line'>  "reset PAGER to `less' when getting man pages."
</span><span class='line'>  (let ((old (getenv "PAGER")))
</span><span class='line'>    (setenv "PAGER" "less")
</span><span class='line'>    ad-do-it
</span><span class='line'>    (setenv "PAGER" old)))</span></code></pre></td></tr></table></div></figure>


<ul>
<li>There is a further problem when running <code>man</code> from the shell, in that <code>man</code> outputs backspace codes for bold/underline and so on. (TODO)</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/07/25/hevea/">Hevea</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-07-25T14:55:01-07:00" pubdate data-updated="true">2014-07-25</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So I wrote a thesis, using some self-torturing chain of LyX, <a href="http://yihui.name/knitr/">knitr</a>, and a build tool of my own devising. It made a PDF, now I want to make it a webpage.</p>

<p>I tried a few tools, and settled on <a href="http://hevea.inria.fr/">HeVeA</a> as the tool that showed the most promise (as in, &lsquo;it actually generated some HTML for a subset of my files, within a few hours of work&rsquo;). That&rsquo;s not close to &ldquo;working&rdquo; though.</p>

<p>Currently, I&rsquo;m having a problem where a <code>\ref{}</code> is processed correctly by LaTeX, producing a link labeled &ldquo;Figure x&rdquo;, but incorrectly by Hevea, including the entire caption, like so:</p>

<p>Error processing input, expected syntax: {% img [class name(s)] [http[s]:/]/path/to/image [width [height]] [title text | &ldquo;title text&rdquo; [&ldquo;alt text&rdquo;]] %}</p>

<p>Disabling the <code>hyperref</code> and <code>refstyle</code> packages didn&rsquo;t do much. I seem to remember also having this problem when using a <code>ref{}</code> to another figure inside of a figure caption but I am not sure how that was resolved.</p>

<p>This is one problem with LaTeX projects, they become hard to troubleshoot. For any two things you want to do in LaTeX, there are four packages offering each, for 16 combinations, each of which will be grossly or subtly incompatible in some way.</p>

<p>In this case, something somewhere is fucking with the generation of reference labels or something. The actual HTML looks like:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;#mov%3Auncrowded&quot;</span><span class="nt">&gt;</span>2.1(demo_circle_6.mov) An example
</span><span class='line'>motion stimulus similar to those used in my experiments. There are six
</span><span class='line'>elements, with the carrier motion clockwise and the envelope
</span><span class='line'>counterclockwise. The envelope motion dominates the subjective
</span><span class='line'>appearance. figure.caption.2<span class="nt">&lt;/a&gt;</span> shows six elements, so the spacing
</span><span class='line'>between elements
</span></code></pre></td></tr></table></div></figure>


<p>which was constructed from this TeX:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>\ref{mov:uncrowded} shows six elements, so the spacing between elements
</span></code></pre></td></tr></table></div></figure>


<p>Now, part of the fuckup is with hyperref? maybe? Next I need to try constructing a minimal example. Luckily I have a minimal example already&hellip;.</p>

<h3>Some time later</h3>

<p>OK so, turns out the inclusion of figure captions in labels was caused by an ill-thought-out line I had written in <code>trouble.hva</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>\renewcommand{\AtBeginDocument}[1]{}
</span></code></pre></td></tr></table></div></figure>


<p>I had written this to &ldquo;prevent&rdquo; an error that was occurring when <code>hevea</code> was  reading the <code>.aux</code> file, but it also screwed up hyperref. It seems I can&rsquo;t get hyperref to work with hevea, and cleveref.</p>

<h3>Giving up</h3>

<p>After constructing a minimal example, I still couldn&rsquo;t identify a way to make autoref/cleverref references work.</p>

<h2>Tex4ht</h2>

<p>Someone suggested that <code>tex4ht</code> might work better than <code>hevea</code>, and at least it correctly processed my minimal example. That doen&rsquo;t mean it&rsquo;ll process the the whole thesis, though.</p>

<p>The first problem is:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>--- warning --- Can&#39;t find/open file `introduction_chapter.dvi&#39;
</span><span class='line'>--- error --- Can&#39;t find/open file `introduction_chapter.dvi&#39;
</span></code></pre></td></tr></table></div></figure>


<p>Which was because I was using <code>tex4ht</code> and not <code>htlatex</code>. Using <code>htlatex</code> I instead get:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>! I can&#39;t find file `introduction_chapter.html&#39;.
</span><span class='line'><span class="nt">&lt;to</span> <span class="na">be</span> <span class="na">read</span> <span class="na">again</span><span class="nt">&gt;</span>
</span><span class='line'>                   \relax
</span><span class='line'>l.79 \begin{document}
</span></code></pre></td></tr></table></div></figure>


<p>Which is odd since that command is actually supposed to be making the file!</p>

<p>So it must be failing at an earlier stage?</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/21/itunes-library-manipulation-with-python/">iTunes Library Manipulation With Python</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-21T12:13:36-07:00" pubdate data-updated="true">2014-05-21</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Current project: filter out duplicates and CDs with missing tracks from library.</p>

<p>Using: Python/appscript.</p>

<p>Er, first upgrading my Python/IPython?</p>

<p>I followed <a href="http://stupidpythonideas.blogspot.com/2013/02/installing-scipy-etc-for-python-3-on-mac.html">these instructions</a>.</p>

<p>Except that instead of <code>easy_install3.4 readline</code> do <code>pip3 install gnureadline</code>.</p>

<p>And install an old gfortran? I get zombie errors referring to a nonexistent version of homebrew&rsquo;s gfortran.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>brew install python3
</span><span class='line'>pip install --upgrade pip
</span><span class='line'>pip install ipython[notebook]</span></code></pre></td></tr></table></div></figure>


<p>Dammit I just install a binary numpy.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/19/whitespace-mode/">Whitespace-mode</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-19T21:00:35-07:00" pubdate data-updated="true">2014-05-19</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Why does whitespace-mode fuck up longlines mode when it&rsquo;s supposed to be disabled?</p>

<p>I&rsquo;d like to edit markdown files with longlines-mode (word wrapping). Clearly when longlines-mode is enabled, I don&rsquo;t want to highlight 80+ char lines, as I_do when editing code. However, I still want the other whitespace-mode features (highlight trailing spaces, tabs, etc)</p>

<p>I have, in my markdown-mode modehook:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  (when whitespace-mode
</span><span class='line'>    (whitespace-mode 'disable)
</span><span class='line'>    (setq-local whitespace-style (remove 'lines-tail whitespace-style)))</span></code></pre></td></tr></table></div></figure>


<p>It doesn&rsquo;t work. Lines longer than 80char still get highlighted.</p>

<p>But indeed &lsquo;lines-tail does not appear in whitespace-style. However, too late: this came after whitespace-mode had initialized, and so it&rsquo;s already set up.</p>

<p>Moving to a lighlighted char and doing <code>(face-at-point)</code> reveals <code>whitespace-line</code>.</p>

<p>Disabling font-lock-mode disables all highlighting.</p>

<p><code>font-lock-fontify-buffer</code> doesn&rsquo;t do it.</p>

<p><code>font-lock-keywords-alist</code> does not contain anything pertaining to whitespace-mode.</p>

<p>Hmmm. maybe I can locally redefine the face.</p>

<p><code>font-lock-keywords</code> is not buffer local. It contains this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>("^\\([^ \n]\\{4\\}\\|[^ \n]\\{0,3\\}    \\)\\{20\\}\\(.+\\)$"
</span><span class='line'>(2 whitespace-line t))</span></code></pre></td></tr></table></div></figure>


<p>If I remove <code>lines-tail</code> f rom <code>whitespace-style</code> before loading the buffer&hellip; the offending highlighting does not take place.</p>

<p>So I need to to the remove before enabling whitespace mode? and make it buffer-local?</p>

<p>So, I made sure that the modification to whitespace-style occurred before whitespace-mode was enabled. That did the trick, I think.</p>

<p>So, here:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(add-hook 'markdown-mode-hook 'pbm-markdown-fonts)
</span><span class='line'>
</span><span class='line'>(defun pbm-markdown-fonts ()
</span><span class='line'>  ;Use variable pitch fonts, and wrap long lines.
</span><span class='line'>  (variable-pitch-mode t)
</span><span class='line'>  (if whitespace-mode
</span><span class='line'>      (error "markdown mode needs configured before whitespace mode is enabled"))
</span><span class='line'>  (setq-local whitespace-style (remove 'lines-tail whitespace-style))
</span><span class='line'>  (visual-line-mode)
</span><span class='line'>  (set-visual-wrap-column 75)
</span><span class='line'>  (font-lock-fontify-buffer))</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/15/time-shifting-an-internet-stream/">Time Shifting an Internet Stream With VLC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-15T17:31:07-07:00" pubdate data-updated="true">2014-05-15</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want to listen to this <a href="http://www.brap.fm/2014/05/14/the-shiso-room-yppah-guest-mix-16-05-14/">upcoming show</a> but don&rsquo;t know if it&rsquo;ll be downloadable later.</p>

<p>I worked out a VLC command line:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/Applications/VLC.app/Contents/MacOS/VLC \
</span><span class='line'>http://delicious.wavestreamer.com:4626/listen.pls?sid=1 \
</span><span class='line'>    vlc://quit \
</span><span class='line'>    --network-caching=10000 \
</span><span class='line'>    --sout /Users/peter/2014-05-16_yppah_shisho_room_mix.ogg \
</span><span class='line'>    --run-time=7400 \
</span><span class='line'>    --intf rc</span></code></pre></td></tr></table></div></figure>


<p>I put the command in an executable <code>.sh</code> file and scheduled it to run using LaunchControl.</p>

<h3>huh?</h3>

<p>Note that I mistakenly tried to actually read the documentation and used</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>--sout "#standard{access=file,mux=ogg,dst=/Users/peter/2014-05-16_yppah_shisho_room_mix.ogg}"</span></code></pre></td></tr></table></div></figure>


<p>I don&rsquo;t know what&rsquo;s srong or missing about this, but VLC decided to treat it as a filename instead of the syntax in the <a href="http://www.videolan.org/doc/streaming-howto/en/ch03.html">docs</a>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[0x109c21840] filesystem access error: cannot open file /Users/peter/blog/#standard{access=file,mux=ogg,dst=/Users/peter/2014-05-16_yppah_shisho_room_mix.ogg} (No such file or directory)</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/09/20/racket-and-flycheck-mode/">Racket and Flycheck-mode</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/09/fixing-geiser-racket-repls-error-links/">Fixing Geiser-racket-repl&#8217;s Error Links</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/09/editing-regexes-interactively-in-emacs/">Editing Structured Regexes Interactively in Emacs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/09/05/get-emacs-set-up-for-racket/">Get Emacs Set Up for Racket</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/08/23/a-strange-writing-tic/">A Strange Writing Tic</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/crowding">@crowding</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'crowding',
            count: 2,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>My Pinboard</h1>
  <ul id="pinboard_linkroll">Fetching linkroll&#8230;</ul>
  <p><a href="http://pinboard.in/u:crowding">My Pinboard Bookmarks &raquo;</a></p>
</section>
<script type="text/javascript">
  var linkroll = 'pinboard_linkroll'; //id target for pinboard list
  var pinboard_user = "crowding"; //id target for pinboard list
  var pinboard_count = 3; //id target for pinboard list
  (function(){
    var pinboardInit = document.createElement('script');
    pinboardInit.type = 'text/javascript';
    pinboardInit.async = true;
    pinboardInit.src = '/javascripts/pinboard.js';
    document.getElementsByTagName('head')[0].appendChild(pinboardInit);
  })();
</script>


<section class="twitter">
  <a class="twitter-timeline" href="https://twitter.com/perisaccadic" data-widget-id="448287882478764032">Tweets by @perisaccadic</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Peter Meilstrup -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
